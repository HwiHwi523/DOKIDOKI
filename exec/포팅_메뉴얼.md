# 포팅 매뉴얼 상세

## 환경 상세

### 형상 관리

- GitLab

### 이슈 관리

- Jira

### 커뮤니케이션

- Mattermost
- Notion

### IDE

- Intellij CE 2022.3
- Visual Studio Code
- vim

### Server

- AWS EC2
  - Ubuntu 20.04 LTS
  - Docker 23.0.1

### Frontend

- React 18.2.0
  - Redux 4.2.0
  - Redux RTK 1.9.1
- TypeScript 4.9.5
- Material UI 5.11.5

### Backend

- Java OpenJDK 11
- SpringBoot Gradle 2.7.9
  - Spring Data JPA
  - Spring Cloud Gateway
  - Lombok

### Database

- MySQL 8.0.32
- Redis 

### Infra

- Jenkins 2.387.1
- docker-compose 2.16.0
- Nginx

## 프로젝트 구조

![Untitled](../README/project_structure.png)


## Docker 설치

```bash
# apt 업데이트
sudo apt-get update

# 필수 요소 설치
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common

# docker gpg 키 설치
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
OK

# docker 레포지토리 추가
sudo add-apt-repository \
   "deb [arch=amd64] https://download.docker.com/linux/ubuntu \
   $(lsb_release -cs) \
   stable"

# apt 업데이트
sudo apt-get update

# docker 설치
sudo apt-get install docker-ce docker-ce-cli containerd.io

# docker 실행 권한 추가
sudo usermod -aG docker ubuntu

# docker-compose 설치
sudo curl -L https://github.com/docker/compose/releases/download/v2.16.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose

# docker-compose 실행권한 추가
sudo chmod +x /usr/local/bin/docker-compose
```

## 젠킨스 설치

```bash
sudo apt-get install jenkins

# 설치 이후 안내되는 내용대로 환경 설정을 진행하면 된다.
```

## 젠킨스 플러그인 설치

- Git, GitLab, NodeJS 관련 플러그인을 설치해주면 된다.

## 젠킨스 프로젝트 설정

- Git의 경우 아래와 같이 token으로 접근하는 url을 입력해주면 된다.
  ![Untitled](../README/jenkins_1.png)
- push 혹은 merge 이벤트 발생시 자동으로 빌드를 진행하기 위해서는 아래와 같이 설정한다.
  ![Untitled](../README/jenkins_2.png)

```bash
# 빌드 스크립트는 아래의 것을 사용한다

docker image prune -f
docker-compose build --parallel
docker-compose up -d
```

## 전체 빌드 방법

```bash
# one-shot 빌드를 제공하므로 개별 이미지를 따로 테스트하는 목적이 아닐 경우 전체 빌드를 권장한다.
# 빌드 스크립트는 Git Repository를 clone한 폴더에서 아래의 명령어를 입력한다

docker image prune -f
docker-compose build --parallel
docker-compose up -d
```



## MySQL ERD

![erd.png](../README/erd.png)

